// Optimized JavaScript for Brujo Jacob website
(function(){
    'use strict';
    
    const words = [
        'los mejores brujos','brujos de verdad','brujos cerca de mi','brujos y hechiceros',
        'brujos gratis en linea','brujeria negra','hechizos efectivos','tarot brujo',
        'brujos en estados unidos','vudu brujeria','brujos consulta gratis','bruja',
        'hechiceria','hechizo de amor','amarres de amor','hechizos efectivos',
        'conjuro de amor','un amarre','amarres de amor brujeria','amarres efectivos para el amor',
        'amarre a una persona','amarre amor','hechizo de endulzamiento','endulzamiento de amor',
        'amarre de brujeria','espiritismo y santeria','espiritismo','centro espiritista',
        'centro espiritista cerca de mi','brujo amarres','magia negra para el amor',
        'hechizo para que regrese','como hacer un amarre de amor','un amarre de amor',
        'hechizos para recuperar a tu pareja','brujo para amarres','que tan efectivo es un amarre de amor',
        'amarres de amor near me','necesito un amarre de amor urgente','necesito un amarre de amor',
        'los amarres son verdaderos','amarre de amor cerca de mi','brujeria','brujos',
        'endulzamiento de pareja','brujeria brujeria','espiritista near me','brujos amarres',
        'amarres de amor','brujeria para el amor','como hacer un amarre','poderoso amarre de amor',
        'amarres gratis sin pagar nada','hechizo para una persona','conjuro amor','amarres fuertes',
        'conjuros efectivos','endulzamiento fuerte','los brujos','la brujeria',
        'endulzamiento efectivo','hechizo amarre amor','espiritualistas','brujeria de amor',
        'Brujeria','Amarres de amor','Hechicería','Magia blanca','Magia negra',
        'Encantamientos','Sortilegios','Conjuros','Hechizos','Espiritismo','Exorcismos',
        'Santeria','hacer un amarre','endulzamientos','brujos reales','hechizos de amor',
        'endulzamiento','brujo real','el brujo mayor','quitar brujeria','brujeria real',
        'brujeria es real','amarre sexual','amarres sexuales','brujo mayor',
        'rituales de canela','endulzamientos con miel y canela','brujería y santería',
        'hacer brujeria','como amarrar aun hombre','santeria y brujeria','brujeria santeria',
        'santería y brujería','santeria brujo','santeria es brujeria','amarres de amor caseros',
        'salmos contra la brujería','los amarres de amor funcionan','brujo blanca',
        'amarre brujeria','rituales de abundancia','brujeria cubana','amarres brujeria',
        'brujeria amarre','brujos cubanos','endulzamientos con miel y nombre',
        'hechizo para que me llame','hechizo para separar a dos personas','hechizo del zapato',
        'brujeria negra','ritual para atraer dinero','amarre de amor que es','amarre con orina',
        'amarres caseros','amarres de pareja','amarre con menstruación',
        'hechizo fuerte para que me llame de inmediato','salmo 29 contra brujería',
        'hechizo para alejar a una persona','amarres para el amor','endulzamiento con miel',
        'brujeria verde','amarre de amor con orina','un amarre','brujos y hechiceros',
        'trabajos de brujeria','rituales con la santa muerte','brujos colombianos',
        'hechizos de luna','amarres de amor con la orina','hechizos harry potter',
        'hechizos caseros para que me escriba en 5 minutos','rituales de luna llena',
        'ritual para alejar a una persona','los brujos','endulzamiento de amor',
        'endulzamientos de amor','brujeria de amor','rituales con canela','brujeria haitiana',
        'brujería haitiana','brujeria magia negra','quitar amarres','amuletos contra la brujeria',
        'limpia de brujeria','foto de brujeria','amuletos contra brujeria','mexico brujeria',
        'hechizo para que me llame en 5 minutos','hechizo del vaso de agua para que te llame',
        'amarres de amor efectivos','hechizo de la cebolla','los amarres funcionan',
        'ritual para separar a dos personas','rituales de amor','brujeria blanca','brujo wicca',
        'ritual de amor','ritual para el dinero','rituales de santeria',
        'hechizos para que me llame en 5 minutos','brujos mexicanas','ser brujo',
        'amarres con la santa muerte','brujeria mexicana','wicca brujo','hechizos con cebolla',
        'brujeria con la santa muerte','hacer un endulzamiento','rituales con luna llena',
        'santa muerte brujeria','amarres con santa muerte','amarres de amor gratis',
        'amarres amorosos','brujos famosos','hechizo del zapato para dominar',
        'amarre con ropa interior','hechizos de proteccion','hechizo para dominar a un hombre',
        'hechizo para separar una pareja','brujos de verdad','brujos buenos','amarre con foto',
        'rituales para el amor','ritual para que me llame','hechizo para enamorar a un hombre',
        'brujeria con velas','hechizo para que me hable','hechizo para que me escriba',
        'hechizo para atraer el amor','ritual para atraer el amor','hechizo para que me llame de inmediato',
        'hechizo para que me llame ya','hechizo para que me llame urgente','hechizo para el amor',
        'hechizo para que me ame','hechizo para que me busque','hechizo para que me extrañe',
        'hechizo para que me desee','hechizo para que me piense','hechizo para que me necesite',
        'hechizo para que me quiera'
    ];
    
    function getRandomWords() {
        const randomWords = [];
        const wordsCopy = [...words];
        for (let i = 0; i < 8; i++) {
            const randomIndex = Math.floor(Math.random() * wordsCopy.length);
            randomWords.push(wordsCopy[randomIndex]);
            wordsCopy.splice(randomIndex, 1);
        }
        return randomWords;
    }
    
    function initKeywords() {
        const container = document.getElementById('wordsContainer');
        if (!container) return;
        
        const randomWords = getRandomWords();
        randomWords.forEach(word => {
            const boldWord = document.createElement('strong');
            boldWord.innerText = word;
            container.appendChild(boldWord);
            container.appendChild(document.createTextNode(' '));
        });
    }
    
    function initWhatsApp() {
        // Obtener la configuración de WhatsApp
        const whatsappNumber = typeof CONFIG !== 'undefined' ? CONFIG.whatsapp.number : '12545956299';
        const defaultMessage = typeof CONFIG !== 'undefined' ? CONFIG.whatsapp.defaultMessage : 'NECESITO%20AYUDA';
        
        const whatsappContainer = document.getElementById('whatsapp-container');
        if (whatsappContainer) {
            whatsappContainer.addEventListener('click', function() {
                window.open(`https://wa.me/+${whatsappNumber}?text=${defaultMessage}`, '_blank');
            });
        }
    }
    
    function initWhatsAppForm() {
        // Obtener la configuración de WhatsApp
        const whatsappNumber = typeof CONFIG !== 'undefined' ? CONFIG.whatsapp.number : '12545956299';
        
        const sendMessage = document.getElementById('sendMessage');
        if (sendMessage) {
            sendMessage.addEventListener('click', function(e) {
                e.preventDefault();
                const name = document.getElementById('name').value;
                const message = document.getElementById('message').value;
                
                if (name && message) {
                    const whatsappText = `Hola, soy ${name}. ${message}`;
                    const encodedText = encodeURIComponent(whatsappText);
                    const whatsappUrl = `https://wa.me/+${whatsappNumber}?text=${encodedText}`;
                    window.open(whatsappUrl, '_blank');
                } else {
                    alert('Por favor completa todos los campos');
                }
            });
        }
    }
    
    function initPerformanceOptimizations() {
        if ('IntersectionObserver' in window) {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        if (entry.target.hasAttribute('data-src')) {
                            entry.target.src = entry.target.dataset.src;
                            entry.target.removeAttribute('data-src');
                        }
                        if (entry.target.classList.contains('animate-on-scroll')) {
                            entry.target.classList.add('animated');
                        }
                        observer.unobserve(entry.target);
                    }
                });
            }, {
                rootMargin: '100px',
                threshold: 0.1
            });
            
            document.querySelectorAll('[data-src], .animate-on-scroll').forEach(el => {
                observer.observe(el);
            });
        }
        
        if ('requestIdleCallback' in window) {
            requestIdleCallback(() => {
                document.querySelectorAll('img:not([loading])').forEach(img => {
                    if (!img.classList.contains('logo') && !img.classList.contains('critical')) {
                        img.setAttribute('loading', 'lazy');
                    }
                });
            });
        }
    }
    
    function initAnimations() {
        const animatedElements = document.querySelectorAll('.animated');
        animatedElements.forEach(el => {
            const rect = el.getBoundingClientRect();
            const isVisible = rect.top >= -rect.height && 
                             rect.left >= -rect.width && 
                             rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) + rect.height && 
                             rect.right <= (window.innerWidth || document.documentElement.clientWidth) + rect.width;
            
            if (!isVisible && el.style.animationPlayState !== 'paused') {
                el.style.animationPlayState = 'paused';
            } else if (isVisible && el.style.animationPlayState === 'paused') {
                el.style.animationPlayState = 'running';
            }
        });
    }
    
    function init() {
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            setTimeout(init, 100);
        }
    }
    
    function init() {
        // Cargar configuración si no está cargada
        if (typeof CONFIG === 'undefined') {
            const configScript = document.createElement('script');
            configScript.src = './js/config.js';
            configScript.onload = function() {
                // Inicializar después de cargar la configuración
                initKeywords();
                initWhatsApp();
                initWhatsAppForm();
                initPerformanceOptimizations();
                setInterval(initAnimations, 2000);
            };
            document.head.appendChild(configScript);
        } else {
            // Configuración ya cargada
            initKeywords();
            initWhatsApp();
            initWhatsAppForm();
            initPerformanceOptimizations();
            setInterval(initAnimations, 2000);
        }
    }
    
    init();
})();